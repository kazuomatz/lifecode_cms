<%#- encoding: UTF-8 -%>
<!---
#  _list.html.erb
#  Generated by LifeCodeCMS Scaffold Generator
-->
<% search_columns = model.search_columns %>
<div class="card search-box">
  <div class="card-header">
    <strong><i class="fas fa-search"></i>ã€€<$$= Settings.form.label.search $$></strong>
  </div>
  <div class="card-body">
    <div class="row">
      <%- search_columns.each do |name| -%>
      <$$- column = <%= model.name %>.form_column('<%= name %>') -$$>
      <%- column = model.form_column(name) -%>
      <%- if name.to_s.index('prefecture_code').present? -%>
      <%= ApplicationController::render partial: 'rails/views/search_box_prefecture', locals:{ column: column, model: model } -%>
      <%- elsif name.to_s.index('city_code').present? -%>
      <%= ApplicationController::render partial: 'rails/views/search_box_city', locals:{ column: column, model: model } -%>
      <%- elsif column && (column[:type] == :datetime || column[:type]) == :timestamp -%>
      <%= ApplicationController::render partial: 'rails/views/search_box_datetime', locals:{ column: column, model: model } -%>
      <%- elsif column && (column[:options].present?) -%>
      <%= ApplicationController::render partial: 'rails/views/search_box_radio', locals:{ column: column, model: model } -%>
      <%- else -%>
      <%= ApplicationController::render partial: 'rails/views/search_box_text_field', locals:{ column: column, model: model } -%>
      <%- end -%>
      <%- end -%>
      <hr/>
      <div class="col-sm-12 search-box-buttons">
        <button type="button" class="clear-button btn btn-primary btn-lg"><i class="fas fa-redo"></i> <$$= Settings.form.label.clear $$></button>
        <button type="button" class="search-button btn btn-primary btn-lg"><i class="fas fa-search"></i> <$$= Settings.form.label.search $$></button>
      </div>
    </div>
  </div>
</div>

<$$- content_for :add_js do $$>
<script>
  // search Parameter
  function searchParams() {
    return {
     'page': '<$$= params[:page] || 1 $$>',
      <%- search_columns.each_with_index do |name, index| -%>
      '<%= name -%>' : $('[name="<%= name %>"]').val()<%= index == search_columns.length - 1 ? '' : ',' %>
      <%- end -%>
    };
  }
  $(function() {
      new FormManager({el: '.search-box'}).init();
  })
</script>
<$$- end $$>
